<!DOCTYPE html>
<html lang="en">

<head>
            <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="Krzysztof Żuraw">


        <title>JSON Web Tokens in django application- part two</title>

            <link href="https://krzysztofzuraw.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Krzysztof Żuraw Full Atom Feed" />
            <link href="https://krzysztofzuraw.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Krzysztof Żuraw RSS Feed" />
            <link href="https://krzysztofzuraw.com/feeds/blog.atom.xml" type="application/atom+xml" rel="alternate" title="Krzysztof Żuraw Categories Atom Feed" />
        <!-- Bootstrap Core CSS -->
        <link href="https://krzysztofzuraw.com/theme/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom CSS -->
        <link href="https://krzysztofzuraw.com/theme/css/clean-blog.min.css" rel="stylesheet">

        <!-- Code highlight color scheme -->
            <link href="https://krzysztofzuraw.com/theme/css/code_blocks/monokai.css" rel="stylesheet">


        <!-- Custom Fonts -->
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->



        <meta name="description" content="Building simple django rest application">

        <meta name="author" content="Krzysztof Żuraw">

        <meta name="tags" content="django">
        <meta name="tags" content="tutorial">

	                <meta property="og:locale" content="en_US.utf8">
		<meta property="og:site_name" content="Krzysztof Żuraw">

	<meta property="og:type" content="article">
            <meta property="article:author" content="Krzysztof Żuraw" >
	<meta property="og:url" content="https://krzysztofzuraw.com/blog/2016/jwt-in-django-application-part-two.html">
	<meta property="og:title" content="JSON Web Tokens in django application- part two">
	<meta property="article:published_time" content="2016-10-23 09:00:00+02:00">
            <meta property="og:description" content="Building simple django rest application">

            <meta property="og:image" content="https://krzysztofzuraw.com//images/covers/jwt.jpg">
            <meta name="twitter:card" content="summary_large_image" />
            <meta name="twitter:image" content="/images/covers/jwt.jpg">
        <meta name="twitter:site" content="@krzysztof_zuraw" />
        <meta name="twitter:title" content="JSON Web Tokens in django application- part two" />
            <meta name="twitter:description" content="Building simple django rest application" />
            <meta name="twitter:image" content="https://krzysztofzuraw.com//images/covers/jwt.jpg">
</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://krzysztofzuraw.com/">Krzysztof Żuraw</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

                        <li><a href="/pages/about.html">About</a></li>
                        <li><a href="/archives.html">Archive</a></li>
                        <li><a href="/tags.html">Tags</a></li>
                        <li><a href="http://feeds.feedburner.com/krzysztofzuraw">RSS Feed</a></li>
                        <li><a href="https://feedburner.google.com/fb/a/mailverify?uri=krzysztofzuraw&amp;loc=en_US">Email Updates</a></li>


                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Header -->
        <header class="intro-header" style="background-image: url('/images/covers/jwt.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1 >JSON Web Tokens in django application- part two</h1>
                            <h3 class="subheading" >Building simple django rest application</h3>
                        <span class="meta">Posted on Sun 23 October 2016
                        </span>
                        
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    <!-- Post Content -->
    <!-- TOC -->

    <article>
        <p><strong>In this blog post, I will deal with creating simple Django application for
creating tasks using django rest framework.</strong></p>
<p>From this blog post, you can learn how to setup basic DRF application.</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents:</p>
<ul class="simple">
<li><a class="reference internal" href="#overview-of-application" id="id1">Overview of application</a></li>
<li><a class="reference internal" href="#application-code" id="id2">Application code</a></li>
<li><a class="reference internal" href="#other-blog-posts-in-this-series" id="id3">Other blog posts in this series</a></li>
</ul>
</div>
<div class="section" id="overview-of-application">
<h2><a class="toc-backref" href="#id1">Overview of application</a></h2>
<p>The main goal of this application is to create tasks. Each task has a title - string with
a maximum length of 100 characters. Task also has a person to which it is bound (many to one
relation - ForeginKey). The last thing that task have is date and time which given task is
due to. The user can easily modify each of tasks so GET, POST, PUT and DELETE methods are
supported.</p>
<p>As we know how the application is designed let's jump into the code.</p>
</div>
<div class="section" id="application-code">
<h2><a class="toc-backref" href="#id2">Application code</a></h2>
<p>First, there is a need to create model for Task:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>


<span class="k">class</span> <span class="nc">Task</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">person</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">User</span><span class="p">)</span>
    <span class="n">due_to</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Task with title: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
</pre></div>
<p>The arguments of <tt class="docutils literal">Task</tt> correspond to what was written in the overview.</p>
<p>As we have models ready now it's time to create serializers so data from database
can be converted to stream of bytes:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">serializers</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Task</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>


<span class="k">class</span> <span class="nc">TaskSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">HyperlinkedModelSerializer</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Task</span>


<span class="k">class</span> <span class="nc">UserSerializer</span><span class="p">(</span><span class="n">serializers</span><span class="o">.</span><span class="n">ModelSerializer</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">User</span>
</pre></div>
<p>As you can see in <tt class="docutils literal">TaskSerializer</tt> I used <tt class="docutils literal">HyperlinkedModelSerializer</tt> as a
type of serializer that I want to use - thanks to that response from my application
will have hyperlinks to resources instead of just primary keys that are used in
<tt class="docutils literal">UserSerializer</tt>. In this serializer, I use django <tt class="docutils literal">User</tt> as a source of data.
I have to do this because <tt class="docutils literal">Task</tt> model has a reference to <tt class="docutils literal">User</tt> and without
serialization of the second one I cannot serialize the task.</p>
<p>Right now I have my models and serializers ready so it's time to create some views
and urls. For a typical usage of views, DRF gives you generic viewsets like
<a class="reference external" href="http://www.django-rest-framework.org/api-guide/viewsets/#modelviewset">ModelViewSet</a>.
ViewSet is a combination of the logic for a set of related views in a single class.
How do views look like?</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rest_framework</span> <span class="kn">import</span> <span class="n">viewsets</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Task</span>
<span class="kn">from</span> <span class="nn">.serializers</span> <span class="kn">import</span> <span class="n">TaskSerializer</span><span class="p">,</span> <span class="n">UserSerializer</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="kn">import</span> <span class="n">User</span>


<span class="k">class</span> <span class="nc">TaskViewSet</span><span class="p">(</span><span class="n">viewsets</span><span class="o">.</span><span class="n">ModelViewSet</span><span class="p">):</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">Task</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">TaskSerializer</span>


<span class="k">class</span> <span class="nc">UserViewSet</span><span class="p">(</span><span class="n">viewsets</span><span class="o">.</span><span class="n">ModelViewSet</span><span class="p">):</span>
    <span class="n">queryset</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="n">serializer_class</span> <span class="o">=</span> <span class="n">UserSerializer</span>
</pre></div>
<p>I created 2 viewsets. The only thing that I need to provide is queryset and serializer_class
arguments so viewsets know which data they needed to take and which serializer use. Right now
there is only one thing missing - urls:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">tasks</span> <span class="kn">import</span> <span class="n">views</span>
<span class="kn">from</span> <span class="nn">rest_framework.routers</span> <span class="kn">import</span> <span class="n">DefaultRouter</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">DefaultRouter</span><span class="p">()</span>
<span class="n">router</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;tasks&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">TaskViewSet</span><span class="p">)</span>
<span class="n">router</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;users&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">UserViewSet</span><span class="p">)</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">router</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
<span class="p">]</span>
</pre></div>
<p>Here I set up <tt class="docutils literal">DefaultRouter</tt> and hook <tt class="docutils literal">TaskViewSet</tt> and <tt class="docutils literal">UserViewSet</tt> to it. Router
is a way of building common routes for a resource. To get all tasks - I go to <tt class="docutils literal">/tasks</tt>
uri. To retrieve first task I type <tt class="docutils literal">tasks/1</tt>. I can write this in urlpatterns but the router
is doing the same for me automatically.</p>
<p>Right now I can try my application:</p>
<div class="highlight"><pre><span></span>$ http GET <span class="m">127</span>.0.0.1:9000
HTTP/1.0 <span class="m">200</span> OK
Allow: GET, HEAD, OPTIONS
Content-Type: application/json
Date: Sun, <span class="m">23</span> Oct <span class="m">2016</span> <span class="m">08</span>:36:23 GMT
Server: WSGIServer/0.2 CPython/3.5.1
Vary: Accept, Cookie
X-Frame-Options: SAMEORIGIN

<span class="o">{</span>
    <span class="s2">&quot;tasks&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/tasks/&quot;</span>,
    <span class="s2">&quot;users&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/users/&quot;</span>
<span class="o">}</span>


$ http GET <span class="m">127</span>.0.0.1:9000/tasks/
HTTP/1.0 <span class="m">200</span> OK
Allow: GET, POST, HEAD, OPTIONS
Content-Type: application/json
Date: Sun, <span class="m">23</span> Oct <span class="m">2016</span> <span class="m">08</span>:45:50 GMT
Server: WSGIServer/0.2 CPython/3.5.1
Vary: Accept, Cookie
X-Frame-Options: SAMEORIGIN

<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&quot;due_to&quot;</span>: <span class="s2">&quot;2016-10-18T19:12:01Z&quot;</span>,
        <span class="s2">&quot;person&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/users/1/&quot;</span>,
        <span class="s2">&quot;title&quot;</span>: <span class="s2">&quot;First one&quot;</span>,
        <span class="s2">&quot;url&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/tasks/1/&quot;</span>
    <span class="o">}</span>,
    <span class="o">{</span>
        <span class="s2">&quot;due_to&quot;</span>: <span class="s2">&quot;2016-10-18T19:12:10Z&quot;</span>,
        <span class="s2">&quot;person&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/users/1/&quot;</span>,
        <span class="s2">&quot;title&quot;</span>: <span class="s2">&quot;Second one&quot;</span>,
        <span class="s2">&quot;url&quot;</span>: <span class="s2">&quot;http://127.0.0.1:9000/tasks/2/&quot;</span>
    <span class="o">}</span>
<span class="o">]</span>
</pre></div>
<p>That's all for today! In the next post, I will make authentication with JWT. Stay
tuned!</p>
<p>Code for this blog post is under this <a class="reference external" href="https://github.com/krzysztofzuraw/personal-blog-projects/tree/master/blog_jwt">github</a>.</p>
</div>
<div class="section" id="other-blog-posts-in-this-series">
<h2><a class="toc-backref" href="#id3">Other blog posts in this series</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://krzysztofzuraw.com/blog/2016/jwt-in-django-application-part-one.html">JSON Web Tokens in django application- part one</a></li>
<li><a class="reference external" href="https://krzysztofzuraw.com/blog/2016/jwt-in-django-application-part-three.html">JSON Web Tokens in django application- part three</a></li>
<li><a class="reference external" href="https://krzysztofzuraw.com/blog/2016/jwt-in-django-application-part-four.html">JSON Web Tokens in django application- part four</a></li>
</ul>
<p>Special thanks to Kasia for being editor for this post. Thank you.</p>
<p>Cover picture by <a class="reference external" href="https://pixabay.com/pl/users/Lalmch-1026205/">Lalmch</a> under <a class="reference external" href="https://creativecommons.org/publicdomain/zero/1.0/deed.en">CC0 Public Domain</a>.</p>
</div>

    </article>

        <div class="tags">
            <p>tags: <a href="https://krzysztofzuraw.com/tag/django.html">django</a>, <a href="https://krzysztofzuraw.com/tag/tutorial.html">tutorial</a>, </p>
        </div>
        <p>If you find this blog post interesting please share:</p>
        <div class="addthis_sharing_toolbox"></div>
        <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-57a7802d9a259bbe"></script>

        <div class="comments">
            <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'krzysztofzuraw';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//krzysztofzuraw.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
            </div>
        </div>
    </div>

    <hr>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                            <li>
                                <a href="https://twitter.com/krzysztof_zuraw">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/krzysztofzuraw">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="mailto:krzysztof.zuraw@gmail.com">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li>
                                <a href="https://pl.linkedin.com/in/krzysztofzuraw">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                    </ul>
<p class="copyright text-muted">
    Blog powered by <a href="http://getpelican.com">Pelican</a>,
    which takes great advantage of <a href="http://python.org">Python</a>.
    This site use cookies for disqus and google analitics.
</p>                </div>
            </div>
        </div>
    </footer>

    <!-- jQuery -->
    <script src="https://krzysztofzuraw.com/theme/js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="https://krzysztofzuraw.com/theme/js/bootstrap.min.js"></script>

        <!-- Custom Theme JavaScript -->
        <script src="https://krzysztofzuraw.com/theme/js/clean-blog.min.js"></script>

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72188452-2']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'krzysztofzuraw';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>

</html>